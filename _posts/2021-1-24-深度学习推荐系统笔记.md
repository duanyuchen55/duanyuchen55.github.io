---
title: 《深度学习推荐系统》笔记
tags: 
    - DL
    - RS
mathjax: true
mathjax_autoNumber: true
comment: true
key: 《深度学习推荐系统》笔记
---

## 3.7 FM与深度学习模型的结合

### 3.7.1 FNN——用FM的隐向量完成Embedding层初始化

​		神经网络的参数初始化通常采用不包含任何先验信息的随机初始化，而Embedding层的输入极端稀疏化，导致Embedding层收敛缓慢，且Embedding层参数量占绝大部分，进而导致模型收敛受限于Embedding层。

​		FNN模型解决上述问题的思路：使用FM模型训练好的各特征隐向量初始化Embedding层的参数（引入先验信息）**书p79：图3-8及下面第一段话**

​		FNN模型也为Embedding预训练提供了借鉴思路。

​		

### 3.7.2 DeepFM——用FM代替Wide部分

​		FNN把FM的训练结果作为初始化权重，并未对神经网络的结构进行更改。

​		DeepFM对Wide&Deep的改进在于：用FM替换了Wide部分，加强了浅层网络部分特征组合的能力。**书p80：图3-9及下面第一段话**

​		针对Wide&Deep的改进动机，DeepFM和Deep&Cross完全一样，只不过进行特征组合的方法不一样，前者使用FM，后者使用多层Cross网络。



### 3.7.3 NFM——FM的神经网络化尝试

​		在数学形式上，NFM模型的主要思路是用一个表达能力更强的函数代替FM中的二阶隐向量内积的部分
$$
\hat{y}_{FM}(x) = w_0+\sum_{i=1}^N{w_ix_i}+\sum_{i=1}^N\sum_{j=i+1}^N{v_i^tv_j\cdot x_ix_j}
$$

$$
\hat{y}_{NFM}(x)=w_0+\sum_{i=1}^{N}w_ix_i+f(x)
$$


​		$f(x)$的构造工作可以交由某个深度学习网络来完成，并且通过BP来学习。

​		NFM的这个神经网络架构特点：在Embedding层和多层神经网络之间加入特征交叉池化层。

​		若把NFM的一阶部分看作一个线性模型，则NFM架构也可以视为Wide&Deep模型的进化。NFM模型对Wide&Deep模型的Deep部分加入了特征交叉池化层，加强了特征交叉。



### 3.7.4 基于FM的深度学习模型的优点和局限性

​		FNN、DeepFM、NFM都是在经典的多层神经网络的基础上加入有针对性的特征交叉操作，使模型具有更强的非线性表达能力。

​		特征工程的思路已经穷尽了可能的尝试，提升空间很小。



## 3.8 注意力机制在推荐模型中的应用

### 3.8.1 AFM——引入注意力机制的FM

​		注意力机制，基于假设——“不同的交叉特征”对于结果的影响程度不同。AFM模型引入注意力机制是通过在特征交叉层和最终的输出层之间加入注意力网络实现的。注意力网络的作用是为每一个交叉特征提供权重（注意力得分）

​		为了防止交叉特征数据稀疏带来权重参数难以收敛的问题，AFM使用了一个粥两两特征交叉层和池化层之间的注意力网络来生成注意力得分。



### 3.8.2 DIN——引入注意力机制的深度学习网络

​		应用场景：阿里巴巴电商广告推荐。

​		计算一个用户u是否点击广告a时，模型的输入特征分为两类：

1. 用户u的特征组。用户特征组里的商品id/商铺id序列，表示用户点击过的商品/商铺集合。
2. 候选广告a的特征组。广告特征里的商品id和商铺id代表：广告对应的商品id和商铺id。

利用候选商品和历史性为商品之间的相关性计算出一个权重，该权重就代表了“注意力”的强弱。注意力权重+深度学习网络=DIN模型，注意力形式化表达如下：
$$
V_u = f(V_a)=\sum_{i=1}^{N}{w_i \cdot V_i}=\sum_{i=1}^{N}{g(V_i, V_a)} \cdot V_i
$$
$V_i$是用户的Embedding向量。$V_a$是候选广告商品的Embedding向量。$V_i$是用户u的第i次行为的Embedding向量。

用户的行为就是浏览商品和店铺，因此行为的Embedding向量就是那次浏览商品或者店铺的Embedding向量。

$g(V_i,V_a)$使用一个激活单元activation unit来生成注意力得分，输入层是两个Embedding向量，经过元素减操作后，与原Embedding向量一同连接后形成全链接层的输入，最后通过单神经元输出层生成注意力得分。



### 3.8.3 注意力机制对推荐系统的启发

​		注意力机制在数学形式上，只是将过去的平均操作或加和操作 换成了 加权求和或加权平均操作。



## 3.9 DIEN——序列模型与推荐系统的结合